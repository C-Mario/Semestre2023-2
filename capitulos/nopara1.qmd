---
title: "Capítulo 1 del curso"
---

## Estimación histograma de la densidad

\newcommand{\lr}[1]{\left(#1\right)}
\newcommand{\var}[1]{\textrm{Var}\left[#1\right]}
\newcommand{\esp}[1]{\textrm{E}\left[#1\right]}
\newcommand{\rm}[1]{\textrm{#1}}

La idea es que una variable aleatoria tiene un proceso o función de densidad subyacente la cuál genera los datos que tendremos finalmente a disposición. Dada una variable aleatoria $X$, entonces $X \sim f\left(x;\theta\right)$. En el caso paramétrico la estimación de la función de densidad estaría dada por $\hat f \left(x;\theta\right) = f\left(x;\hat{\theta}\right)$ asumiendo que la población de la cuál provienen los datos sigue una distribución conocida con función de densidad $f$.

En el caso no paramétrico, no se hace supuesto alguno sobre la función de densidad asociada a la población de la cuál provienen los datos. La estimación de la función de densidad puede hacerse por diferentes métodos, entre ellos los siguientes:

-   Histograma
-   Polígono de frecuencias
-   Núcleo (kernel)

El primer enfonque es realizar la estimación de la función de densidad usando la **estimación histograma de la densidad**. Por ejemplo, si se tienen 100 datos cuyo histograma de frecuencias absolutas está dado por:

```{r}
x <- rnorm(100, 0, 1)
hist(x, freq=TRUE, col = "#42A5F5")
```

La estimación histograma de la densidad dados estos 100 datos es el siguiente:

```{r}
hist(x, freq=FALSE, col = "#42A5F5")
```

Para realizar la estimación se tiene en cuenta lo siguiente:

-   $f\left(x\right)$ es la función de densidad asociada a la variable aleatoria $X$
-   $\hat{f}\left(x\right)$ es la estimación de la función de densidad
-   $\hat f_H \left(x\right)$ es la estimación histograma de la función de densidad
-   El área de cada rectángulo del histograma se denota por $f_j$ y depende del número de datos cuyo valor cae en el dicho intervalo y del número total de datos, de tal manera que $f_j = \frac{n_j}{n}$
-   El área de cada rectángulo también puede verse en términos de la estimación histograma y de la amplitud del intervalo. $\hat{f}_H \left(x\right) \times 2b$ donde $b$ es un valor a la derecha y a la izquierda del centro del intervalo.

Así, se tiene que si la amplitud del intervalo es $2b$, entonces:

$$\frac{n_j}{n} = 2b \hat{f}_H \left(x\right)$$ $$\hat{f}_H \left(x\right)=\frac{n_j}{2nb} \hspace{0.5cm} \textrm{donde} \hspace{0.5cm} n_j=\sum_{i=1}^n \mathbf{I}_{\left[x-b, x+b\right]} \left(x_i\right)$$ Ahora, según $n_j$ se tiene que:

$$ 
\begin{align}
x-b \leq x_i \leq x+&b\\
-b \leq x_i-x \leq &b\\
-1 \leq \frac{x_i-x}{b} \leq 1
\end{align}
$$ y por lo tanto

$$n_j = \sum_{i=1}^n \mathbf{I}_{\left[-1,1\right]}\left(\frac{x_i-x}{b}\right)$$

luego, la estimación histograma de la densidad puede escribirse como:

$$\hat{f}_H \left(x\right) = \frac{1}{nb} \sum_{i=1}^n \frac{1}{2} \mathbf{I}_{\left[-1,1\right]}\left(\frac{x_i-x}{b}\right) = \frac{1}{nb} \sum_{i=1}^n K_U\left(u\right)$$ donde

$$u = \left(\frac{x_i-x}{b}\right) \hspace{0.5cm} \mathrm{y} \hspace{0.5cm} K_U\left(u\right) = \begin{cases}\frac{1}{2} & -1<u<1 \\ 0 & \text { e.o.c }\end{cases}$$ $K_U$ es un kernel uniforme. Es decir, es una función de densidad centrada en $0$ y toma valores de la forma $u$ entre $-1$ y $1$.

Si ahora se supone que la amplitud del intervalo es $b$, entonces se tiene que:

$$\frac{n_j}{n} = b\hat{f}_H \left(x\right)$$ $$\hat{f}_H \left(x\right)=\frac{n_j}{nb} \hspace{0.5cm} \textrm{donde} \hspace{0.5cm} n_j=\sum_{i=1}^n \mathbf{I}_{\left[x-\frac{b}{2}, x+\frac{b}{2}\right]} \left(x_i\right)$$ de $n_j$ se tiene que

$$ 
\begin{align}
x-\frac{b}{2} \leq x_i \leq x+&\frac{b}{2}\\
-\frac{b}{2} \leq x_i-x \leq &\frac{b}{2}\\
-\frac{1}{2} \leq \frac{x_i-x}{b} \leq &\frac{1}{2}
\end{align}
$$ y por lo tanto:

$$\hat{f}_H \left(x\right)=\frac{1}{nb} \sum_{i=1}^n \mathbf{I}_{\left[-\frac{1}{2},\frac{1}{2}\right]}\left(\frac{x_i-x}{b}\right)=\frac{1}{nb}K_U\left(u\right)$$ donde

$$u = \left(\frac{x_i-x}{b}\right) \hspace{0.5cm} \mathrm{y} \hspace{0.5cm} K_U\left(u\right) = \begin{cases} 1 & -\frac{1}{2}<u<\frac{1}{2} \\ 0 & \text { e.o.c }\end{cases}$$ en forma general, si la amplitud del intervalo es $ab$ entonces:

$$\hat{f}_H \left(x\right)=\frac{1}{nb} \sum_{i=1}^n \frac{1}{a} \mathbf{I}_{\left[-\frac{ab}{2},\frac{ab}{2}\right]}\left(\frac{x_i-x}{b}\right)=\frac{1}{nb}K_U\left(u\right)$$ donde

$$u = \left(\frac{x_i-x}{b}\right) \hspace{0.5cm} \mathrm{y} \hspace{0.5cm} K_U\left(u\right) = \begin{cases} \frac{1}{a} & -\frac{ab}{2}<u<\frac{ab}{2} \\ 0 & \text { e.o.c }\end{cases}$$ 

## Propiedades del estimador histograma

Dado que el estimador histograma de la densidad depende de la amplitud $b$ del intervalo, la idea es escoger el valor de la amplitud que minimice el $\textrm{MSE}$ para así poder encontrar una estimación más exacta de la función de densidad subyacente a la población en cuestión.

\begin{align}
\var{\hat b - b} &= \esp{\lr{\hat b - b}^2} - \lr{\esp{\hat b - b}}^2\\
\var{\hat b} &= \underbrace{\esp{\lr{\hat b - b}^2}}_{\textrm{MSE}} - \underbrace{\lr{\esp{\hat b}-b}^2}_{\textrm{BIAS}^2}\\
\end{align}

y despejando, se tiene que:

$$\underbrace{\esp{\lr{\hat b - b}^2}}_{\rm{MSE}} = \var{\hat b} + \underbrace{\lr{\esp{\hat b}-b}^2}_{\textrm{BIAS}^2}$$

## Notación $O$ y $o$ de Landau

### Notación $O$

$\textrm{Big}-O$ es una notación matemática para describir el comportamiento asintótico de una función, cuando su argumento tiende a un valor en particular o al infinito. Su uso en la computación es análogo, se usa para medir la complejidad de los algoritmos; es decir, la cantidad de operaciones que le toma a un algoritmo realizar internamente para arrojar el resultado final dada una entrada particular del algoritmo.

Por ejemplo, cuando un algoritmo es $O\lr{n^2}$, se dice que es cuadrático en tiempo y se sabe que estaría en el orden de realizar $n^2$ operaciones para procesar una entrada de tamaño $n$.

Para una función dada $g\lr{n}$, $O\lr{g\lr{n}}$ se define como sigue:

$$O\lr{g\lr{n}} = \left\{f\lr{n}: \textrm{existen constantes positivas} \hspace{0.2cm} c \hspace{0.2cm} \textrm{y} \hspace{0.2cm} n_0 \hspace{0.2cm} \textrm{tales que} \hspace{0.2cm} 0 \leq f\lr{n} \leq cg\lr{n} \hspace{0.2cm} \forall \hspace{0.2cm} n \geq n_0 \right\}$$
Esto quiere decir que $O\lr{g\lr{n}}$ es un conjunto de funciones que después de $n_0$ son más pequeñas o a lo sumo iguales que $g\lr{n}$.

```{r}
#| label: ogrande
#| echo: false
#| out-width: ~
#| fig-cap: |
#|   Ejemplo gráfico de la notación Big-O.
#| fig-align: center
#| fig-cap-location: margin
knitr::include_graphics("https://www.baeldung.com/wp-content/uploads/sites/4/2021/06/ogn-292x300-1.png", dpi = 270)
```
En este gráfico, $f\lr{n}$ es solo una de las posibles funciones que pertenecen al conjunto de funciones $O\lr{g\lr{n}}$. Antes de $n_0$, $f\lr{n}$ no siempre es más pequeña que $g\lr{n}$, pero después de $n_0$ nunca sobrepasa a $g\lr{n}$.

- El signo $\lr{=}$ en la expresión $f\lr{n}=O\lr{g\lr{n}}$ es una representación asintótica la cuál da a entender que cuando $n$ se hace muy grande, $f\lr{n}$ y $g\lr{n}$ crecen a la misma velocidad.

Por ejemplo, $3n^3=O\lr{n^3}$ mientras que $3n\ne O\lr{n^3}$.

```{r}
#| label: ogrande2
#| echo: false
#| out-width: ~
#| fig-cap: |
#|   Ejemplo gráfico de la notación Big-O.
#| fig-align: center
#| fig-cap-location: margin
#| out.width: "30%"
knitr::include_graphics("C:/Users/dofca/Desktop/libro/images/ogrande2.png", dpi = 270)
```

Para verificar que $f\lr{n} = O\lr{g\lr{n}}$, debe existir al menor una constante $c$ con la cuál se cumpla la siguiente desigualdad:
$$\left|f\lr{n}\right|\leq c\left|g\lr{n}\right| \hspace{0.2cm} \forall \hspace{0.2cm} n \geq n_0.$$

### Notación $o$

La notación $o$ es usadapara denotar una cota superior que no es asintóticamente "ajustada", o sea es estrictamente menor.

Para una función dada $g\lr{n}$, $o\lr{g\lr{n}}$ se define como sigue:

$$o\lr{g\lr{n}} = \left\{f\lr{n}: \textrm{para cualquier constante postivia} \hspace{0.2cm} c, \hspace{0.2cm} \textrm{existe una constante positiva} \hspace{0.2cm} n_0 \hspace{0.2cm} \textrm{tal que} \hspace{0.2cm} 0 \leq f\lr{n} < cg\lr{n} \hspace{0.2cm} \forall \hspace{0.2cm} n \geq n_0 \right\}$$
En esta definición, el conjunto de funciones $f\lr{n}$ son estrictamente más pequeñas que $cg\lr{n}$, por lo cuál la notación $o$ es una cpta superior más fuerte que la notación $O$.

- La notaci;on $o$ no permite que la función $f\lr{n}$ tenga la misma velocidad de crecimiento que $g\lr{n}$.

Esto significa que a medida que $n$ se hace grande, $f\lr{n}$ se vuelve insignificante respecto a $g\lr{n}$, es decir:

$$\lim_{n \to \infty} \frac{f\lr{n}}{g\lr{n}} = 0$$

- En la definición de la notación $o$, la desigualdad debe cumplirse para cualquier constante $c$, mientras que en la notación $O$, es suficiente que algún $c$ satisfaga la desigualdad.

- Haciendo una analogía con números reales $a$ y $b$ es algo así como:
$f\lr{n}=O\lr{g\lr{n}} \approx a\leq b$ mientras que $f\lr{n}=o\lr{g\lr{n}} \approx a < b$.
