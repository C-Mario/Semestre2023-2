---
title: "Estimación histograma de la densidad"
---

\newcommand{\lr}[1]{\left(#1\right)}
\newcommand{\var}[1]{\textrm{Var}\left[#1\right]}
\newcommand{\esp}[1]{\textrm{E}\left[#1\right]}
\newcommand{\rm}[1]{\textrm{#1}}



La idea es que una variable aleatoria tiene un proceso o función de densidad subyacente la cuál genera los datos que tendremos finalmente a disposición. Dada una variable aleatoria $X$, entonces $X \sim f\left(x;\theta\right)$. En el caso paramétrico la estimación de la función de densidad estaría dada por $\hat f \left(x;\theta\right) = f\left(x;\hat{\theta}\right)$ asumiendo que la población de la cuál provienen los datos sigue una distribución conocida con función de densidad $f$.

En el caso no paramétrico, no se hace supuesto alguno sobre la función de densidad asociada a la población de la cuál provienen los datos. La estimación de la función de densidad puede hacerse por diferentes métodos, entre ellos los siguientes:

-   Histograma
-   Polígono de frecuencias
-   Núcleo (kernel)

El primer enfonque es realizar la estimación de la función de densidad usando la **estimación histograma de la densidad**. Por ejemplo, si se tienen 100 datos cuyo histograma de frecuencias absolutas está dado por:

```{r}
x <- rnorm(100, 0, 1)
hist(x, freq=TRUE, col = "#42A5F5")
```

La estimación histograma de la densidad dados estos 100 datos es el siguiente:

```{r}
hist(x, freq=FALSE, col = "#42A5F5")
```

Para realizar la estimación se tiene en cuenta lo siguiente:

-   $f\left(x\right)$ es la función de densidad asociada a la variable aleatoria $X$
-   $\hat{f}\left(x\right)$ es la estimación de la función de densidad
-   $\hat f_H \left(x\right)$ es la estimación histograma de la función de densidad
-   El área de cada rectángulo del histograma se denota por $f_j$ y depende del número de datos cuyo valor cae en el dicho intervalo y del número total de datos, de tal manera que $f_j = \frac{n_j}{n}$
-   El área de cada rectángulo también puede verse en términos de la estimación histograma y de la amplitud del intervalo. $\hat{f}_H \left(x\right) \times 2b$ donde $b$ es un valor a la derecha y a la izquierda del centro del intervalo.

Así, se tiene que si la amplitud del intervalo es $2b$, entonces:

$$\frac{n_j}{n} = 2b \hat{f}_H \left(x\right)$$ $$\hat{f}_H \left(x\right)=\frac{n_j}{2nb} \hspace{0.5cm} \textrm{donde} \hspace{0.5cm} n_j=\sum_{i=1}^n \mathbf{I}_{\left[x-b, x+b\right]} \left(x_i\right)$$ Ahora, según $n_j$ se tiene que:

$$ 
\begin{align}
x-b \leq x_i \leq x+&b\\
-b \leq x_i-x \leq &b\\
-1 \leq \frac{x_i-x}{b} \leq 1
\end{align}
$$ y por lo tanto

$$n_j = \sum_{i=1}^n \mathbf{I}_{\left[-1,1\right]}\left(\frac{x_i-x}{b}\right)$$

luego, la estimación histograma de la densidad puede escribirse como:

$$\hat{f}_H \left(x\right) = \frac{1}{nb} \sum_{i=1}^n \frac{1}{2} \mathbf{I}_{\left[-1,1\right]}\left(\frac{x_i-x}{b}\right) = \frac{1}{nb} \sum_{i=1}^n K_U\left(u\right)$$ donde

$$u = \left(\frac{x_i-x}{b}\right) \hspace{0.5cm} \mathrm{y} \hspace{0.5cm} K_U\left(u\right) = \begin{cases}\frac{1}{2} & -1<u<1 \\ 0 & \text { e.o.c }\end{cases}$$ $K_U$ es un kernel uniforme. Es decir, es una función de densidad centrada en $0$ y toma valores de la forma $u$ entre $-1$ y $1$.

Si ahora se supone que la amplitud del intervalo es $b$, entonces se tiene que:

$$\frac{n_j}{n} = b\hat{f}_H \left(x\right)$$ $$\hat{f}_H \left(x\right)=\frac{n_j}{nb} \hspace{0.5cm} \textrm{donde} \hspace{0.5cm} n_j=\sum_{i=1}^n \mathbf{I}_{\left[x-\frac{b}{2}, x+\frac{b}{2}\right]} \left(x_i\right)$$ de $n_j$ se tiene que

$$ 
\begin{align}
x-\frac{b}{2} \leq x_i \leq x+&\frac{b}{2}\\
-\frac{b}{2} \leq x_i-x \leq &\frac{b}{2}\\
-\frac{1}{2} \leq \frac{x_i-x}{b} \leq &\frac{1}{2}
\end{align}
$$ y por lo tanto:

$$\hat{f}_H \left(x\right)=\frac{1}{nb} \sum_{i=1}^n \mathbf{I}_{\left[-\frac{1}{2},\frac{1}{2}\right]}\left(\frac{x_i-x}{b}\right)=\frac{1}{nb}K_U\left(u\right)$$ donde

$$u = \left(\frac{x_i-x}{b}\right) \hspace{0.5cm} \mathrm{y} \hspace{0.5cm} K_U\left(u\right) = \begin{cases} 1 & -\frac{1}{2}<u<\frac{1}{2} \\ 0 & \text { e.o.c }\end{cases}$$ en forma general, si la amplitud del intervalo es $ab$ entonces:

$$\hat{f}_H \left(x\right)=\frac{1}{nb} \sum_{i=1}^n \frac{1}{a} \mathbf{I}_{\left[-\frac{ab}{2},\frac{ab}{2}\right]}\left(\frac{x_i-x}{b}\right)=\frac{1}{nb}K_U\left(u\right)$$ donde

$$u = \left(\frac{x_i-x}{b}\right) \hspace{0.5cm} \mathrm{y} \hspace{0.5cm} K_U\left(u\right) = \begin{cases} \frac{1}{a} & -\frac{ab}{2}<u<\frac{ab}{2} \\ 0 & \text { e.o.c }\end{cases}$$ 

## Propiedades del estimador histograma

Dado que el estimador histograma de la densidad depende de la amplitud $b$ del intervalo, la idea es escoger el valor de la amplitud que minimice el $\textrm{MSE}$ para así poder encontrar una estimación más exacta de la función de densidad subyacente a la población en cuestión.

\begin{align}
\var{\hat b - b} &= \esp{\lr{\hat b - b}^2} - \lr{\esp{\hat b - b}}^2\\
\var{\hat b} &= \underbrace{\esp{\lr{\hat b - b}^2}}_{\textrm{MSE}} - \underbrace{\lr{\esp{\hat b}-b}^2}_{\textrm{BIAS}^2}\\
\end{align}

y despejando, se tiene que:

$$\underbrace{\esp{\lr{\hat b - b}^2}}_{\rm{MSE}} = \var{\hat b} + \underbrace{\lr{\esp{\hat b}-b}^2}_{\textrm{BIAS}^2}$$
